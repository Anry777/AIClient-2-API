<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="theme-color" content="#059669">
    <meta name="description" content="AIClient2API Management Console - Unified AI provider management">
    <title>AIClient2API - Management Console</title>
    <link rel="stylesheet" href="app/styles.css">
    <link rel="stylesheet" href="app/mobile.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1><i class="fas fa-robot"></i> <span class="header-title">AIClient2API Management Console</span></h1>
                <div class="header-controls">
                    <span class="status-badge" id="serverStatus">
                        <i class="fas fa-circle"></i> <span class="status-text">Connecting...</span>
                    </span>
                    <button id="logoutBtn" class="logout-btn" title="Logout">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                    </span>
                    <button id="refreshBtn" class="logout-btn" aria-label="Refresh data">
                        <i class="fas fa-sync-alt"></i> <span class="btn-text">Reload</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar" role="navigation" aria-label="Main navigation">
                <nav class="sidebar-nav">
                    <a href="#dashboard" class="nav-item active" data-section="dashboard" aria-label="Dashboard">
                        <i class="fas fa-tachometer-alt" aria-hidden="true"></i> <span>Dashboard</span>
                    </a>
                    <a href="#config" class="nav-item" data-section="config" aria-label="Configuration">
                        <i class="fas fa-cog" aria-hidden="true"></i> <span>Configuration</span>
                    </a>
                    <a href="#providers" class="nav-item" data-section="providers" aria-label="Provider Pools">
                        <i class="fas fa-network-wired" aria-hidden="true"></i> <span>Provider Pools</span>
                    </a>
                    <a href="#upload-config" class="nav-item" data-section="upload-config" aria-label="Upload Configs">
                        <i class="fas fa-upload" aria-hidden="true"></i> <span>Upload Configs</span>
                    </a>
                    <a href="#logs" class="nav-item" data-section="logs" aria-label="Logs">
                        <i class="fas fa-file-alt" aria-hidden="true"></i> <span>Logs</span>
                    </a>
                </nav>
            </aside>

            <!-- Content Area -->
            <main class="content" role="main">
                <!-- Dashboard Section -->
                <section id="dashboard" class="section active" aria-labelledby="dashboard-title">
                    <h2 id="dashboard-title">System Overview</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="uptime">--</h3>
                                <p>Uptime</p>
                            </div>
                        </div>
                    </div>
                    <!-- System Information Panel -->
                    <div class="system-info-panel">
                        <h3>System Information</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">
                                    <i class="fas fa-code"></i> Node.js Version
                                </span>
                                <span class="info-value" id="nodeVersion">--</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">
                                    <i class="fas fa-clock"></i> Server Time
                                </span>
                                <span class="info-value" id="serverTime">--</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">
                                    <i class="fas fa-memory"></i> Memory Usage
                                </span>
                                <span class="info-value" id="memoryUsage">--</span>
                            </div>
                        </div>
                    </div>

                    <!-- Path Routing Examples Panel -->
                    <div class="routing-examples-panel">
                        <h3><i class="fas fa-route"></i> Path Routing Examples</h3>
                        <p class="routing-description">Access different AI providers via path-based routing and switch
                            models flexibly</p>

                        <div class="routing-examples-grid">
                            <div class="routing-example-card" data-provider="gemini-cli-oauth-card">
                                <div class="routing-card-header">
                                    <i class="fas fa-gem"></i>
                                    <h4>Gemini CLI OAuth</h4>
                                    <span class="provider-badge oauth">Bypass limits</span>
                                </div>
                                <div class="routing-card-content">
                                    <!-- Protocol tab switching -->
                                    <div class="protocol-tabs">
                                        <button class="protocol-tab" data-protocol="openai">OpenAI</button>
                                        <button class="protocol-tab active" data-protocol="claude">Claude</button>
                                    </div>

                                    <!-- OpenAI protocol example -->
                                    <div class="protocol-content" data-protocol="openai">
                                        <div class="endpoint-info">
                                            <label>Endpoint path:</label>
                                            <code class="endpoint-path">/gemini-cli-oauth/v1/chat/completions</code>
                                        </div>
                                        <div class="usage-example">
                                            <label>Example (OpenAI format):</label>
                                            <pre><code>curl http://localhost:3000/gemini-cli-oauth/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "model": "gemini-2.0-flash-exp",
    "messages": [{"role": "user", "content": "Hello!"}],
    "max_tokens": 1000
  }'</code></pre>
                                        </div>
                                    </div>

                                    <!-- Claude protocol example -->
                                    <div class="protocol-content active" data-protocol="claude">
                                        <div class="endpoint-info">
                                            <label>Endpoint path:</label>
                                            <code class="endpoint-path">/gemini-cli-oauth/v1/messages</code>
                                        </div>
                                        <div class="usage-example">
                                            <label>Example (Claude format):</label>
                                            <pre><code>curl http://localhost:3000/gemini-cli-oauth/v1/messages \
  -H "Content-Type: application/json" \
  -H "X-API-Key: YOUR_API_KEY" \
  -d '{
    "model": "gemini-2.0-flash-exp",
    "max_tokens": 1000,
    "messages": [{"role": "user", "content": "Hello!"}]
  }'</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="routing-example-card" data-provider="gemini-antigravity-card">
                                <div class="routing-card-header">
                                    <i class="fas fa-rocket"></i>
                                    <h4>Gemini Antigravity</h4>
                                    <span class="provider-badge oauth">Bypass limits / Experimental</span>
                                </div>
                                <div class="routing-card-content">
                                    <!-- Protocol tab switching -->
                                    <div class="protocol-tabs">
                                        <button class="protocol-tab" data-protocol="openai">OpenAI</button>
                                        <button class="protocol-tab active" data-protocol="claude">Claude</button>
                                    </div>

                                    <!-- OpenAI protocol example -->
                                    <div class="protocol-content" data-protocol="openai">
                                        <div class="endpoint-info">
                                            <label>Endpoint path:</label>
                                            <code class="endpoint-path">/gemini-antigravity/v1/chat/completions</code>
                                        </div>
                                        <div class="usage-example">
                                            <label>Example (OpenAI format):</label>
                                            <pre><code>curl http://localhost:3000/gemini-antigravity/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "model": "gemini-3-pro-preview",
    "messages": [{"role": "user", "content": "Hello!"}],
    "max_tokens": 1000
  }'</code></pre>
                                        </div>
                                    </div>

                                    <!-- Claude protocol example -->
                                    <div class="protocol-content active" data-protocol="claude">
                                        <div class="endpoint-info">
                                            <label>Endpoint path:</label>
                                            <code class="endpoint-path">/gemini-antigravity/v1/messages</code>
                                        </div>
                                        <div class="usage-example">
                                            <label>Example (Claude format):</label>
                                            <pre><code>curl http://localhost:3000/gemini-antigravity/v1/messages \
  -H "Content-Type: application/json" \
  -H "X-API-Key: YOUR_API_KEY" \
  -d '{
    "model": "gemini-3-pro-preview",
    "max_tokens": 1000,
    "messages": [{"role": "user", "content": "Hello!"}]
  }'</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="routing-example-card" data-provider="claude-custom-card">
                                <div class="routing-card-header">
                                    <i class="fas fa-brain"></i>
                                    <h4>Claude Custom</h4>
                                    <span class="provider-badge official">Official / 3rd-party</span>
                                </div>
                                <div class="routing-card-content">
                                    <!-- Protocol tab switching -->
                                    <div class="protocol-tabs">
                                        <button class="protocol-tab" data-protocol="openai">OpenAI</button>
                                        <button class="protocol-tab active" data-protocol="claude">Claude</button>
                                    </div>

                                    <!-- OpenAI protocol example -->
                                    <div class="protocol-content" data-protocol="openai">
                                        <div class="endpoint-info">
                                            <label>Endpoint path:</label>
                                            <code class="endpoint-path">/claude-custom/v1/chat/completions</code>
                                        </div>
                                        <div class="usage-example">
                                            <label>Example (OpenAI format):</label>
                                            <pre><code>curl http://localhost:3000/claude-custom/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "model": "claude-3-sonnet-20240229",
    "messages": [{"role": "user", "content": "Hello!"}],
    "max_tokens": 1000
  }'</code></pre>
                                        </div>
                                    </div>

                                    <!-- Claude protocol example -->
                                    <div class="protocol-content active" data-protocol="claude">
                                        <div class="endpoint-info">
                                            <label>Endpoint path:</label>
                                            <code class="endpoint-path">/claude-custom/v1/messages</code>
                                        </div>
                                        <div class="usage-example">
                                            <label>Example (Claude format):</label>
                                            <pre><code>curl http://localhost:3000/claude-custom/v1/messages \
  -H "Content-Type: application/json" \
  -H "X-API-Key: YOUR_API_KEY" \
  -d '{
    "model": "claude-3-sonnet-20240229",
    "max_tokens": 1000,
    "messages": [{"role": "user", "content": "Hello!"}]
  }'</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="routing-example-card" data-provider="claude-kiro-oauth-card">
                                <div class="routing-card-header">
                                    <i class="fas fa-robot"></i>
                                    <h4>Claude Kiro OAuth</h4>
                                    <span class="provider-badge oauth">Bypass limits / Free</span>
                                </div>
                                <div class="routing-card-content">
                                    <!-- Protocol tab switching -->
                                    <div class="protocol-tabs">
                                        <button class="protocol-tab" data-protocol="openai">OpenAI</button>
                                        <button class="protocol-tab active" data-protocol="claude">Claude</button>
                                    </div>

                                    <!-- OpenAI protocol example -->
                                    <div class="protocol-content" data-protocol="openai">
                                        <div class="endpoint-info">
                                            <label>Endpoint path:</label>
                                            <code class="endpoint-path">/claude-kiro-oauth/v1/chat/completions</code>
                                        </div>
                                        <div class="usage-example">
                                            <label>Example (OpenAI format):</label>
                                            <pre><code>curl http://localhost:3000/claude-kiro-oauth/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "model": "claude-3-5-sonnet-20241022",
    "messages": [{"role": "user", "content": "Hello!"}],
    "max_tokens": 1000
  }'</code></pre>
                                        </div>
                                    </div>

                                    <!-- Claude protocol example -->
                                    <div class="protocol-content active" data-protocol="claude">
                                        <div class="endpoint-info">
                                            <label>Endpoint path:</label>
                                            <code class="endpoint-path">/claude-kiro-oauth/v1/messages</code>
                                        </div>
                                        <div class="usage-example">
                                            <label>Example (Claude format):</label>
                                            <pre><code>curl http://localhost:3000/claude-kiro-oauth/v1/messages \
  -H "Content-Type: application/json" \
  -H "X-API-Key: YOUR_API_KEY" \
  -d '{
    "model": "claude-3-5-sonnet-20241022",
    "max_tokens": 1000,
    "messages": [{"role": "user", "content": "Hello!"}]
  }'</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="routing-example-card" data-provider="openai-custom-card">
                                <div class="routing-card-header">
                                    <i class="fas fa-comments"></i>
                                    <h4>OpenAI Custom</h4>
                                    <span class="provider-badge official">Official / 3rd-party</span>
                                </div>
                                <div class="routing-card-content">
                                    <!-- Protocol tab switching -->
                                    <div class="protocol-tabs">
                                        <button class="protocol-tab" data-protocol="openai">OpenAI</button>
                                        <button class="protocol-tab active" data-protocol="claude">Claude</button>
                                    </div>

                                    <!-- OpenAI protocol example -->
                                    <div class="protocol-content" data-protocol="openai">
                                        <div class="endpoint-info">
                                            <label>Endpoint path:</label>
                                            <code class="endpoint-path">/openai-custom/v1/chat/completions</code>
                                        </div>
                                        <div class="usage-example">
                                            <label>Example (OpenAI format):</label>
                                            <pre><code>curl http://localhost:3000/openai-custom/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "model": "gpt-4",
    "messages": [{"role": "user", "content": "Hello!"}],
    "max_tokens": 1000
  }'</code></pre>
                                        </div>
                                    </div>

                                    <!-- Claude protocol example -->
                                    <div class="protocol-content active" data-protocol="claude">
                                        <div class="endpoint-info">
                                            <label>Endpoint path:</label>
                                            <code class="endpoint-path">/openai-custom/v1/messages</code>
                                        </div>
                                        <div class="usage-example">
                                            <label>Example (Claude format):</label>
                                            <pre><code>curl http://localhost:3000/openai-custom/v1/messages \
  -H "Content-Type: application/json" \
  -H "X-API-Key: YOUR_API_KEY" \
  -d '{
    "model": "gpt-4",
    "max_tokens": 1000,
    "messages": [{"role": "user", "content": "Hello!"}]
  }'</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="routing-example-card" data-provider="openai-qwen-oauth-card">
                                <div class="routing-card-header">
                                    <i class="fas fa-code"></i>
                                    <h4>Qwen OAuth</h4>
                                    <span class="provider-badge oauth">Bypass limits</span>
                                </div>
                                <div class="routing-card-content">
                                    <!-- Protocol tab switching -->
                                    <div class="protocol-tabs">
                                        <button class="protocol-tab" data-protocol="openai">OpenAI</button>
                                        <button class="protocol-tab active" data-protocol="claude">Claude</button>
                                    </div>

                                    <!-- OpenAI protocol example -->
                                    <div class="protocol-content" data-protocol="openai">
                                        <div class="endpoint-info">
                                            <label>Endpoint path:</label>
                                            <code class="endpoint-path">/openai-qwen-oauth/v1/chat/completions</code>
                                        </div>
                                        <div class="usage-example">
                                            <label>Example (OpenAI format):</label>
                                            <pre><code>curl http://localhost:3000/openai-qwen-oauth/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "model": "qwen-turbo",
    "messages": [{"role": "user", "content": "Hello!"}],
    "max_tokens": 1000
  }'</code></pre>
                                        </div>
                                    </div>

                                    <!-- Claude protocol example -->
                                    <div class="protocol-content active" data-protocol="claude">
                                        <div class="endpoint-info">
                                            <label>Endpoint path:</label>
                                            <code class="endpoint-path">/openai-qwen-oauth/v1/messages</code>
                                        </div>
                                        <div class="usage-example">
                                            <label>Example (Claude format):</label>
                                            <pre><code>curl http://localhost:3000/openai-qwen-oauth/v1/messages \
  -H "Content-Type: application/json" \
  -H "X-API-Key: YOUR_API_KEY" \
  -d '{
    "model": "qwen-turbo",
    "max_tokens": 1000,
    "messages": [{"role": "user", "content": "Hello!"}]
  }'</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="routing-tips">
                            <h4><i class="fas fa-lightbulb"></i> Tips</h4>
                            <ul>
                                <li><strong>Instant switch:</strong> Change the URL path to switch providers</li>
                                <li><strong>Client setup:</strong> Configure the API endpoint in Cherry-Studio,
                                    NextChat, Cline, etc.</li>
                                <li><strong>Cross-protocol calls:</strong> Use OpenAI format to call Claude models, or
                                    Claude format to call OpenAI models</li>
                            </ul>
                        </div>
                    </div>


                </section>

                <!-- Configuration Section -->
                <section id="config" class="section" aria-labelledby="config-title">
                    <h2 id="config-title">Configuration</h2>
                    <div class="config-panel">
                        <div class="config-form">
                            <div class="form-group password-input-group">
                                <label for="apiKey">API key</label>
                                <div class="password-input-wrapper">
                                    <input type="password" id="apiKey" class="form-control" placeholder="Enter API key"
                                        autocomplete="off">
                                    <button type="button" class="password-toggle" data-target="apiKey"
                                        aria-label="Show/hide password">
                                        <i class="fas fa-eye" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="host">Host</label>
                                    <input type="text" id="host" class="form-control" value="127.0.0.1">
                                </div>
                                <div class="form-group">
                                    <label for="port">Port</label>
                                    <input type="number" id="port" class="form-control" value="3000">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="modelProvider">Model provider</label>
                                <select id="modelProvider" class="form-control">
                                    <option value="gemini-cli-oauth">Gemini CLI OAuth</option>
                                    <option value="gemini-antigravity">Gemini Antigravity</option>
                                    <option value="openai-custom">OpenAI Custom</option>
                                    <option value="claude-custom">Claude Custom</option>
                                    <option value="claude-kiro-oauth">Claude Kiro OAuth</option>
                                    <option value="openai-qwen-oauth">Qwen OAuth</option>
                                    <option value="openaiResponses-custom">OpenAI Responses</option>
                                </select>
                            </div>

                            <!-- Gemini CLI OAuth configuration -->
                            <div class="provider-config" data-provider="gemini-cli-oauth">
                                <div class="form-group">
                                    <label for="projectId">Project ID</label>
                                    <input type="text" id="projectId" class="form-control"
                                        placeholder="Google Cloud Project ID">
                                </div>
                                <div class="form-group">
                                    <label>OAuth credentials</label>
                                    <div class="radio-group">
                                        <label class="radio-label">
                                            <input type="radio" name="geminiCredsType" value="file" checked>
                                            File path
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="geminiCredsType" value="base64">
                                            Base64
                                        </label>
                                    </div>
                                </div>
                                <div class="form-group" id="geminiCredsBase64Group">
                                    <label for="geminiOauthCredsBase64">OAuth credentials (Base64)</label>
                                    <textarea id="geminiOauthCredsBase64" class="form-control" rows="3"
                                        placeholder="Paste Base64-encoded OAuth credentials"></textarea>
                                </div>
                                <div class="form-group" id="geminiCredsFileGroup" style="display: none;">
                                    <label for="geminiOauthCredsFilePath">OAuth credentials file path</label>
                                    <div class="file-input-group">
                                        <input type="text" id="geminiOauthCredsFilePath" class="form-control"
                                            placeholder="e.g. ~/.gemini/oauth_creds.json">
                                        <button type="button" class="btn btn-outline upload-btn"
                                            data-target="geminiOauthCredsFilePath" aria-label="Upload file">
                                            <i class="fas fa-upload"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Gemini Antigravity configuration -->
                            <div class="provider-config" data-provider="gemini-antigravity" style="display: none;">
                                <div class="form-group">
                                    <label for="antigravityOauthCredsFilePath">OAuth credentials file path</label>
                                    <div class="file-input-group">
                                        <input type="text" id="antigravityOauthCredsFilePath" class="form-control"
                                            placeholder="e.g. ~/.antigravity/oauth_creds.json">
                                        <button type="button" class="btn btn-outline upload-btn"
                                            data-target="antigravityOauthCredsFilePath" aria-label="Upload file">
                                            <i class="fas fa-upload"></i>
                                        </button>
                                    </div>
                                    <small class="form-text">Antigravity uses Google OAuth and requires the credentials
                                        file path</small>
                                </div>
                            </div>

                            <!-- OpenAI Custom configuration -->
                            <div class="provider-config" data-provider="openai-custom" style="display: none;">
                                <div class="form-group password-input-group">
                                    <label for="openaiApiKey">OpenAI API Key</label>
                                    <div class="password-input-wrapper">
                                        <input type="password" id="openaiApiKey" class="form-control"
                                            placeholder="sk-...">
                                        <button type="button" class="password-toggle" data-target="openaiApiKey">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="openaiBaseUrl">OpenAI Base URL</label>
                                    <input type="text" id="openaiBaseUrl" class="form-control"
                                        value="https://api.openai.com/v1" placeholder="e.g. https://api.openai.com/v1">
                                </div>
                            </div>

                            <!-- Claude Custom configuration -->
                            <div class="provider-config" data-provider="claude-custom" style="display: none;">
                                <div class="form-group password-input-group">
                                    <label for="claudeApiKey">Claude API Key</label>
                                    <div class="password-input-wrapper">
                                        <input type="password" id="claudeApiKey" class="form-control"
                                            placeholder="sk-ant-...">
                                        <button type="button" class="password-toggle" data-target="claudeApiKey">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="claudeBaseUrl">Claude Base URL</label>
                                    <input type="text" id="claudeBaseUrl" class="form-control"
                                        value="https://api.anthropic.com" placeholder="e.g. https://api.anthropic.com">
                                </div>
                            </div>

                            <!-- Claude Kiro OAuth configuration -->
                            <div class="provider-config" data-provider="claude-kiro-oauth" style="display: none;">
                                <div class="form-group">
                                    <label>OAuth credentials</label>
                                    <div class="radio-group">
                                        <label class="radio-label">
                                            <input type="radio" name="kiroCredsType" value="file" checked>
                                            File path
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="kiroCredsType" value="base64">
                                            Base64
                                        </label>
                                    </div>
                                </div>
                                <div class="form-group" id="kiroCredsBase64Group">
                                    <label for="kiroOauthCredsBase64">OAuth credentials (Base64)</label>
                                    <textarea id="kiroOauthCredsBase64" class="form-control" rows="3"
                                        placeholder="Paste Base64-encoded OAuth credentials"></textarea>
                                </div>
                                <div class="form-group" id="kiroCredsFileGroup" style="display: none;">
                                    <label for="kiroOauthCredsFilePath">OAuth credentials file path</label>
                                    <div class="file-input-group">
                                        <input type="text" id="kiroOauthCredsFilePath" class="form-control"
                                            placeholder="e.g. ~/.aws/sso/cache/kiro-auth-token.json">
                                        <button type="button" class="btn btn-outline upload-btn"
                                            data-target="kiroOauthCredsFilePath" aria-label="Upload file">
                                            <i class="fas fa-upload"></i>
                                        </button>
                                    </div>
                                    <small class="form-text">
                                        <i class="fas fa-info-circle"></i>
                                        For AWS login, ensure the auth file contains <code>clientId</code> and
                                        <code>clientSecret</code>
                                    </small>
                                </div>
                            </div>

                            <!-- Qwen OAuth configuration -->
                            <div class="provider-config" data-provider="openai-qwen-oauth" style="display: none;">
                                <div class="form-group">
                                    <label for="qwenOauthCredsFilePath">OAuth credentials file path</label>
                                    <div class="file-input-group">
                                        <input type="text" id="qwenOauthCredsFilePath" class="form-control"
                                            placeholder="e.g. ~/.qwen/oauth_creds.json">
                                        <button type="button" class="btn btn-outline upload-btn"
                                            data-target="qwenOauthCredsFilePath" aria-label="Upload file">
                                            <i class="fas fa-upload"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- OpenAI Responses configuration -->
                            <div class="provider-config" data-provider="openaiResponses-custom" style="display: none;">
                                <div class="form-group password-input-group">
                                    <label for="openaiResponsesApiKey">OpenAI API Key</label>
                                    <div class="password-input-wrapper">
                                        <input type="password" id="openaiResponsesApiKey" class="form-control"
                                            placeholder="sk-...">
                                        <button type="button" class="password-toggle"
                                            data-target="openaiResponsesApiKey">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="openaiResponsesBaseUrl">OpenAI Base URL</label>
                                    <input type="text" id="openaiResponsesBaseUrl" class="form-control"
                                        value="https://api.openai.com/v1" placeholder="e.g. https://api.openai.com/v1">
                                </div>
                            </div>

                            <!-- Advanced configuration section -->
                            <div class="advanced-config-section">
                                <h3><i class="fas fa-cogs"></i> Advanced settings</h3>

                                <div class="config-row">
                                    <div class="form-group">
                                        <label for="systemPromptFilePath">System prompt file path</label>
                                        <input type="text" id="systemPromptFilePath" class="form-control"
                                            value="input_system_prompt.txt" placeholder="e.g. input_system_prompt.txt">
                                    </div>
                                    <div class="form-group">
                                        <label for="systemPromptMode">System prompt mode</label>
                                        <select id="systemPromptMode" class="form-control">
                                            <option value="append" selected>Append</option>
                                            <option value="overwrite">Overwrite</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="config-row">
                                    <div class="form-group">
                                        <label for="promptLogBaseName">Prompt log base name</label>
                                        <input type="text" id="promptLogBaseName" class="form-control"
                                            placeholder="e.g. prompt_log">
                                    </div>
                                    <div class="form-group">
                                        <label for="promptLogMode">Prompt log mode</label>
                                        <select id="promptLogMode" class="form-control">
                                            <option value="none">None</option>
                                            <option value="console">Console</option>
                                            <option value="file">File</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="config-row">
                                    <div class="form-group">
                                        <label for="requestMaxRetries">Max retries</label>
                                        <input type="number" id="requestMaxRetries" class="form-control" min="0"
                                            max="10" value="3">
                                    </div>
                                    <div class="form-group">
                                        <label for="requestBaseDelay">Base retry delay (ms)</label>
                                        <input type="number" id="requestBaseDelay" class="form-control" min="0"
                                            step="100" value="1000">
                                    </div>
                                </div>

                                <div class="config-row">
                                    <div class="form-group">
                                        <label for="cronNearMinutes">OAuth refresh interval (minutes)</label>
                                        <input type="number" id="cronNearMinutes" class="form-control" min="1" max="60"
                                            value="1">
                                    </div>
                                    <div class="form-group">
                                        <label for="cronNearMinutes">Enable OAuth auto-refresh (requires
                                            restart)</label>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="cronRefreshToken">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                </div>

                                <div class="form-group pool-section">
                                    <label for="providerPoolsFilePath">Provider pools file path (required)</label>
                                    <input type="text" id="providerPoolsFilePath" class="form-control" value=""
                                        placeholder="Default: provider_pools.json">
                                    <small class="form-text">If provider pools are configured, the pool settings are
                                        used by default. If pools are invalid, it falls back to the default
                                        config.</small>
                                </div>

                                <div class="form-group pool-section">
                                    <label for="maxErrorCount">Max provider error count</label>
                                    <input type="number" id="maxErrorCount" class="form-control" value="3" min="1"
                                        max="10" placeholder="Default: 3">
                                    <small class="form-text">After this many consecutive errors, a provider will be
                                        marked unhealthy (default: 3)</small>
                                </div>

                                <!-- System prompt config moved to bottom -->
                                <div class="form-group system-prompt-section">
                                    <label for="systemPrompt">System prompt</label>
                                    <textarea id="systemPrompt" class="form-control" rows="4"
                                        placeholder="Enter system prompt..."></textarea>
                                </div>

                                <!-- Admin login password config -->
                                <div class="form-group pool-section">
                                    <label for="adminPassword">Admin password</label>
                                    <div class="password-input-wrapper">
                                        <input type="password" id="adminPassword" class="form-control"
                                            placeholder="Set admin password (leave empty to keep unchanged)"
                                            autocomplete="new-password">
                                        <button type="button" class="password-toggle" data-target="adminPassword"
                                            aria-label="Show/hide password">
                                            <i class="fas fa-eye" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                    <small class="form-text">Protects access to the management console. After change,
                                        you need to log in again.</small>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button class="btn btn-success" id="saveConfig">
                                    <i class="fas fa-save"></i> Save
                                </button>
                                <button class="btn btn-secondary" id="resetConfig">
                                    <i class="fas fa-undo"></i> Reset
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Upload Configuration Section -->
                <section id="upload-config" class="section" aria-labelledby="upload-config-title">
                    <h2 id="upload-config-title">Upload Configs</h2>
                    <div class="upload-config-panel">
                        <!-- Search and filter area -->
                        <div class="config-search-panel">
                            <div class="search-controls">
                                <div class="form-group">
                                    <label for="configSearch">Search configs</label>
                                    <div class="search-input-group">
                                        <input type="text" id="configSearch" class="form-control"
                                            placeholder="Enter filename">
                                        <button type="button" class="btn btn-outline" id="searchConfigBtn"
                                            aria-label="Search configs">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="configStatusFilter">Link status</label>
                                    <select id="configStatusFilter" class="form-control">
                                        <option value="">All</option>
                                        <option value="used">Linked</option>
                                        <option value="unused">Not linked</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>&nbsp;</label>
                                    <div class="config-actions">
                                        <button class="btn btn-primary" id="refreshConfigList"
                                            aria-label="Refresh config list">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Config list -->
                        <div class="config-list-container">
                            <div class="config-list-header">
                                <h3>Config files</h3>
                                <div class="config-stats">
                                    <span id="configCount">Total: 0</span>
                                    <span id="usedConfigCount" class="status-used">Linked: 0</span>
                                    <span id="unusedConfigCount" class="status-unused">Not linked: 0</span>
                                    <button id="batchLinkKiroBtn" class="btn-batch-link-kiro"
                                        title="Auto-link unlinked configs under configs/">
                                        <i class="fas fa-link"></i> Auto-link OAuth
                                    </button>
                                </div>
                            </div>
                            <div id="configList" class="config-list">
                                <!-- Config file list will be dynamically generated here -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Provider Pools Section -->
                <section id="providers" class="section" aria-labelledby="providers-title">
                    <h2 id="providers-title">Provider Pools</h2>
                    <div class="pool-description">
                        <div class="highlight-note">
                            <i class="fas fa-info-circle"></i>
                            <span>If provider pools are configured, pools are used by default. If pools are invalid, it
                                falls back to the default config.</span>
                        </div>
                    </div>
                    <!-- Provider Pool Stats -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-server"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="activeConnections">0</h3>
                                <p>Active connections</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-network-wired"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="activeProviders">0</h3>
                                <p>Active providers</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="healthyProviders">0</h3>
                                <p>Healthy providers</p>
                            </div>
                        </div>
                    </div>
                    <div class="providers-container">
                        <div id="providersList" class="providers-list">
                            <!-- Providers will be loaded here -->
                        </div>
                    </div>
                </section>

                <!-- Logs Section -->
                <section id="logs" class="section" aria-labelledby="logs-title">
                    <h2 id="logs-title">Logs</h2>
                    <div class="logs-controls">
                        <button class="btn btn-danger" id="clearLogs" aria-label="Clear all logs">
                            <i class="fas fa-trash" aria-hidden="true"></i> <span>Clear logs</span>
                        </button>
                        <button class="btn btn-primary" id="toggleAutoScroll" data-enabled="true"
                            aria-label="Toggle auto-scroll">
                            <i class="fas fa-arrow-down" aria-hidden="true"></i> <span>Auto-scroll: On</span>
                        </button>
                    </div>
                    <div class="logs-container" id="logsContainer" role="log" aria-live="polite" aria-atomic="false">
                        <!-- Logs will appear here -->
                    </div>
                </section>

            </main>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Scripts -->
    <script src="app/auth.js"></script>
    <script>
        // Check login status on page load
        (async function () {
            const isAuthenticated = await initAuth();
            if (!isAuthenticated) {
                // If not authenticated, initAuth will automatically redirect to login page
                return;
            }
            // Authentication successful, continue loading page
            console.log('User authenticated');

            // Show logout button (if password protection is configured)
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn && localStorage.getItem('authToken')) {
                logoutBtn.style.display = 'inline-block';
                logoutBtn.addEventListener('click', async () => {
                    if (confirm('Are you sure you want to log out?')) {
                        await logout();
                    }
                });
            }

            // Update URL prefix in routing examples
            updateRoutingExamplesURLs();
        })();

        // Update URL prefix in routing examples
        function updateRoutingExamplesURLs() {
            // Base URL of current page
            const baseURL = window.location.origin;
            const cleanBaseURL = baseURL.replace(/\/$/, '');

            // Update all endpoint paths
            const endpointPaths = document.querySelectorAll('.endpoint-path');
            endpointPaths.forEach(element => {
                const originalPath = element.textContent;
                if (!originalPath.startsWith(baseURL)) {
                    const cleanPath = originalPath.startsWith('/') ? originalPath : '/' + originalPath;
                    element.textContent = cleanBaseURL + cleanPath;
                }
            });

            // Update URLs in curl commands
            const curlCodes = document.querySelectorAll('.usage-example pre code');
            curlCodes.forEach(element => {
                const curlCommand = element.textContent;
                // Replace curl URL prefix (http://localhost:3000)
                const updatedCommand = curlCommand.replace(/curl http:\/\/localhost:3000/g, `curl ${cleanBaseURL}`);
                element.textContent = updatedCommand;
            });
        }
    </script>
    <script type="module" src="app/app.js"></script>
</body>

</html>